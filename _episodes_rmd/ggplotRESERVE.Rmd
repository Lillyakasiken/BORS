---
title: "ggplot"
author: "Eva Furrer"
date: "2023-05-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# A short introduction to `ggplot2`

We additionally provide a quick introduction to the widely used package `ggplot2`. It is based on the idea of a grammar of graphics, in other words well defined instructions of how to create a plot.

![](https://carpentries-incubator.github.io/open-science-with-r/img/rstudio-cheatsheet-ggplot.png){: height="500px"}

## Data example

We will not go further into the theoretical details but instead jump right into the practical part. Before creating our first ggplot we load `ggplot2` and have a look at the `cars` dataset that we will use.

```{r}
library(ggplot2)
head(mtcars)
```

## First plot

Running the following command will initialize a ggplot object without yet showing anything since we don't tell it what to show.

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars)
```

To create a plot we have to specify what kind of plot - or geom - we want to use. In this case we want a scatter plot so we choose `geom_point`. For other possibilities check the `ggplot2` documentation (e.g. `?ggplot2`) or just do a Google search. Furthermore we have to specify which columns in our dataset we want to use for which axis. Or in other words assign columns of the data to the x and y aesthetic (`aes`). To check which aesthetic is available for which geom check the *Aesthetics* paragraph in the documentation in the respective geom (e.g. in `?geom_point`).

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp))
```

If we want to show `mpg` on the y-axis and `disp` on the x-axis:

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = disp, y = mpg))
```
If we want a boxplot plot we could do
```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_boxplot(aes(x = mpg))
```

or:

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_boxplot(aes(y = mpg))
```

To color the plot according to another column in the data the `color` (or `colour`) aesthetic can be used.

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl)))
```


## Plot options

Many options to change the appearance of plots are available For example change labels:

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  labs(x = "X - Axis", title = "ggplot2", color = "")
```

Or change the theme (for all options check out the help page from `theme`). Either using a predefined theme.

```{r, fig.height=4, fig.width=4, echo=TRUE}
# preconfigured
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  theme_bw()
```

Or creating your own. (Can you figure out what each of the arguments in `theme` do?)

```{r, fig.height=4, fig.width=4, echo=TRUE}
# change settings yourself
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  theme(panel.background = element_rect(fill = "yellow", color = "red"), 
        plot.background = element_rect(fill = "blue"),
        legend.background = element_rect(fill = "red"), 
        axis.title = element_text(colour = "white"),
        axis.line = element_line(linetype = 7, colour = "black", linewidth = 3),
        panel.grid = element_line(colour = "grey", linewidth = 1, linetype = 2),
        axis.text = element_text(angle = 45, hjust = 1, colour = "lightgrey",
                                 size = 14)
        )
```


Changing the color palette used can be done by using either a custom palette (in this case generated using the `RColorBrewer` package)

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  scale_color_manual(values = RColorBrewer::brewer.pal(3, "Set2"))
```

or by directly using an existing scale (usually of the form `scale_color_NAME`). Further options will be given below.

```{r, fig.height=4, fig.width=4, echo=TRUE}
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  scale_color_viridis_d()
```



&nbsp;

&nbsp;

&nbsp;