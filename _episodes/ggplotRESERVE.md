---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit ggplotRESERVE.md in _episodes_rmd/
title: "ggplot"
author: "Eva Furrer"
date: "2023-05-26"
output: html_document
---



# A short introduction to `ggplot2`

We additionally provide a quick introduction to the widely used package `ggplot2`. It is based on the idea of a grammar of graphics, in other words well defined instructions of how to create a plot.

![](https://carpentries-incubator.github.io/open-science-with-r/img/rstudio-cheatsheet-ggplot.png){: height="500px"}

## Data example

We will not go further into the theoretical details but instead jump right into the practical part. Before creating our first ggplot we load `ggplot2` and have a look at the `cars` dataset that we will use.


```r
library(ggplot2)
head(mtcars)
```

```
##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
```

## First plot

Running the following command will initialize a ggplot object without yet showing anything since we don't tell it what to show.


```r
ggplot(mtcars)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2-1.png)

To create a plot we have to specify what kind of plot - or geom - we want to use. In this case we want a scatter plot so we choose `geom_point`. For other possibilities check the `ggplot2` documentation (e.g. `?ggplot2`) or just do a Google search. Furthermore we have to specify which columns in our dataset we want to use for which axis. Or in other words assign columns of the data to the x and y aesthetic (`aes`). To check which aesthetic is available for which geom check the *Aesthetics* paragraph in the documentation in the respective geom (e.g. in `?geom_point`).


```r
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp))
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-3-1.png)

If we want to show `mpg` on the y-axis and `disp` on the x-axis:


```r
ggplot(mtcars) +
  geom_point(aes(x = disp, y = mpg))
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4-1.png)
If we want a boxplot plot we could do

```r
ggplot(mtcars) +
  geom_boxplot(aes(x = mpg))
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-5-1.png)

or:


```r
ggplot(mtcars) +
  geom_boxplot(aes(y = mpg))
```

![plot of chunk unnamed-chunk-6](figure/unnamed-chunk-6-1.png)

To color the plot according to another column in the data the `color` (or `colour`) aesthetic can be used.


```r
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl)))
```

![plot of chunk unnamed-chunk-7](figure/unnamed-chunk-7-1.png)


## Plot options

Many options to change the appearance of plots are available For example change labels:


```r
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  labs(x = "X - Axis", title = "ggplot2", color = "")
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-8-1.png)

Or change the theme (for all options check out the help page from `theme`). Either using a predefined theme.


```r
# preconfigured
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  theme_bw()
```

![plot of chunk unnamed-chunk-9](figure/unnamed-chunk-9-1.png)

Or creating your own. (Can you figure out what each of the arguments in `theme` do?)


```r
# change settings yourself
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  theme(panel.background = element_rect(fill = "yellow", color = "red"), 
        plot.background = element_rect(fill = "blue"),
        legend.background = element_rect(fill = "red"), 
        axis.title = element_text(colour = "white"),
        axis.line = element_line(linetype = 7, colour = "black", linewidth = 3),
        panel.grid = element_line(colour = "grey", linewidth = 1, linetype = 2),
        axis.text = element_text(angle = 45, hjust = 1, colour = "lightgrey",
                                 size = 14)
        )
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-10-1.png)


Changing the color palette used can be done by using either a custom palette (in this case generated using the `RColorBrewer` package)


```r
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  scale_color_manual(values = RColorBrewer::brewer.pal(3, "Set2"))
```

![plot of chunk unnamed-chunk-11](figure/unnamed-chunk-11-1.png)

or by directly using an existing scale (usually of the form `scale_color_NAME`). Further options will be given below.


```r
ggplot(mtcars) +
  geom_point(aes(x = mpg, y = disp, color = factor(cyl))) +
  scale_color_viridis_d()
```

![plot of chunk unnamed-chunk-12](figure/unnamed-chunk-12-1.png)



&nbsp;

&nbsp;

&nbsp;
